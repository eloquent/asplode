#!/usr/bin/env php
<?php

/*
 * This file is part of the Asplode package.
 *
 * Copyright Â© 2012 Erin Millard
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

// path constants
require
    dirname(__DIR__).
    DIRECTORY_SEPARATOR.'src'.
    DIRECTORY_SEPARATOR.'paths.php'
;

$paths = implode(
    ' ',
    array_map(
        'escapeshellarg',
        array(
            LQNT_SRC_DIR,
            LQNT_TEST_SRC_DIR,
            LQNT_TEST_SUITE_DIR,
        )
    )
);

$reportpathPsr2 = escapeshellarg(LQNT_TEST_REPORT_DIR.'/standards-psr2.txt');
$reportpathPsr = escapeshellarg(LQNT_TEST_REPORT_DIR.'/standards-psr.txt');
$error = false;

passthru(
    'phpcs --standard=PSR2 -p --report-file='.$reportpathPsr2.' '.$paths,
    $code
);
if (0 !== $code) {
    $error = true;
}

passthru(
    'phpcs --standard=PSR -p --report-file='.$reportpathPsr.' '.$paths,
    $code
);
if (0 !== $code) {
    $error = true;
}

if ($error) {
    exit(1);
}
